<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Last Plate Standing</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root {
  --bg:#FFF7E6;--accent:#219EBC;--accent2:#8ECAE6;
  --ok:#2CB67D;--warn:#EF476F;--text:#2B2D42;
  --card:#FFFFFF;--muted:#6C757D;--red:#E76F51;
}
body{margin:0;font-family:Inter,system-ui,sans-serif;background:linear-gradient(120deg,var(--bg),#FFFBEA);color:var(--text);}
header{background:linear-gradient(90deg,var(--accent2),var(--accent));color:white;padding:16px 24px;display:flex;justify-content:space-between;}
main{max-width:1000px;margin:24px auto;padding:0 16px 40px;}
.scene{display:none;background:var(--card);border-radius:16px;box-shadow:0 10px 22px rgba(0,0,0,0.08);padding:24px;margin-bottom:24px;}
.scene.active{display:block;}
.card{border:1px solid #eee;border-radius:12px;padding:16px;background:#fff;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;}
.btn{background:var(--accent);color:white;border:none;padding:10px 16px;border-radius:10px;cursor:pointer;font-weight:600;}
.btn.ok{background:var(--ok);}
table{width:100%;border-collapse:collapse;margin-top:6px;}
th,td{padding:8px;border-bottom:1px solid #eee;}
th{color:var(--muted);}
.cross{color:var(--red);font-weight:bold;}
.cutline{border-top:2px solid var(--warn);}
footer{text-align:center;color:var(--muted);font-size:12px;padding:14px 0 24px;}
</style>
</head>
<body>
<header><h1>Last Plate Standing</h1><div>Controls: W/A navigate • S confirm • Space complete</div></header>
<main>
<section id="scene1" class="scene active">
  <h2>Choose number of players</h2>
  <div class="card"><strong>Players:</strong> <span id="playerCount">2</span>
    <button class="btn" id="prevPlayersBtn">Prev (W)</button>
    <button class="btn" id="nextPlayersBtn">Next (A)</button>
    <button class="btn ok" id="confirmPlayersBtn">Ok (S)</button>
  </div>
</section>

<section id="scene2" class="scene">
  <h2 id="coinSceneTitle">Round 1: Choose your coins</h2>
  <div class="card"><div id="coinBag"></div></div>
</section>

<section id="scene3" class="scene">
  <h2>Browse and buy food</h2>
  <div class="grid" id="foodGrid"></div>
  <div class="card"><h3>Selected</h3><div id="selectedFoodDetails"></div></div>
</section>

<section id="scene5" class="scene">
  <h2>End of round status</h2>
  <table id="statusTable"><thead><tr><th>Player</th><th>Food</th><th>Coins</th><th>Status</th></tr></thead><tbody></tbody></table>
</section>

<section id="scene7" class="scene">
  <h2>Victory</h2>
  <p id="winnerText"></p>
  <button class="btn ok" id="playAgain">Play again</button>
</section>
</main>
<footer>Last Plate Standing</footer>

<script>
const state={players:2,round:1,playersData:[],foodCards:[],selectionIndex:0,scene:1};
const baseFoodDeck=[{id:'milk',name:'Milk',value:2},{id:'bread',name:'Bread',value:3},{id:'rice',name:'Rice',value:3},{id:'veg',name:'Vegetables',value:4},{id:'eggs',name:'Eggs',value:4},{id:'fish',name:'Fish',value:5}];

function showScene(id){state.scene=id;document.querySelectorAll('.scene').forEach(s=>s.classList.remove('active'));document.getElementById('scene'+id).classList.add('active');}
function initPlayers(n){state.playersData=Array.from({length:n},(_,i)=>({id:i,coins:{R:3,Y:3,B:3,S:0},foodValue:0,alive:true,completed:false}));}
function changePlayers(delta){let p=state.players+delta;if(p<2)p=2;if(p>8)p=8;state.players=p;document.getElementById('playerCount').textContent=p;}
document.getElementById('prevPlayersBtn').onclick=()=>changePlayers(-1);
document.getElementById('nextPlayersBtn').onclick=()=>changePlayers(1);
document.getElementById('confirmPlayersBtn').onclick=()=>{initPlayers(state.players);enterShopping();};

function enterShopping(){showScene(3);state.foodCards=baseFoodDeck.map(f=>({...f}));state.selectionIndex=0;renderScene3();}
function renderScene3(){const grid=document.getElementById('foodGrid');grid.innerHTML='';state.foodCards.forEach((fc,idx)=>{const card=document.createElement('div');card.className='card';if(idx===state.selectionIndex){card.style.boxShadow='0 0 0 3px rgba(33,158,188,0.4)';setTimeout(()=>card.scrollIntoView({behavior:'smooth',block:'center'}),0);}card.innerHTML=`<h3>${fc.name}</h3><div>Value ${fc.value}</div>`;grid.appendChild(card);});const sel=state.foodCards[state.selectionIndex];document.getElementById('selectedFoodDetails').textContent=sel?`${sel.name} value ${sel.value}`:'None';}

function enterStatus(){
  showScene(5);
  const tbody=document.querySelector('#statusTable tbody');
  tbody.innerHTML='';
  const threshold=6+(state.round-1)*2;

  let sorted=[...state.playersData].filter(p=>p.alive).sort((a,b)=>b.foodValue-a.foodValue||a.id-b.id);
  let eliminated=new Set();

  sorted.forEach((p,idx)=>{
    const tr=document.createElement('tr');
    let status='';
    if(idx===0){status='❌ Waste';eliminated.add(p.id);}
    if(p.foodValue<threshold){status='Starved';eliminated.add(p.id);}
    tr.innerHTML=`<td>Player ${p.id+1}</td><td>${p.foodValue}</td><td>${p.coins.R}/${p.coins.Y}/${p.coins.B}/${p.coins.S}</td><td class="${status.includes('❌')?'cross':''}">${status}</td>`;
    tbody.appendChild(tr);
    if(idx===0)tr.classList.add('cutline');
  });

  eliminated.forEach(i=>state.playersData[i].alive=false);
  state.playersData.forEach(p=>p.foodValue=0);
  state.round++;
  const aliveCount=state.playersData.filter(p=>p.alive).length;
  if(aliveCount<=1){const winner=state.playersData.find(p=>p.alive);enterVictory(winner?winner.id:null);}
}

function enterVictory(winnerIdx){showScene(7);document.getElementById('winnerText').textContent=winnerIdx!==null?`Player ${winnerIdx+1} wins!`:'No winner';}
document.getElementById('playAgain').onclick=()=>{state.players=2;state.round=1;state.playersData=[];showScene(1);};

document.addEventListener('keydown',e=>{
  const key=e.key.toLowerCase();
  if(state.scene===3){
    if(key==='w')state.selectionIndex=(state.selectionIndex-1+state.foodCards.length)%state.foodCards.length;
    if(key==='a')state.selectionIndex=(state.selectionIndex+1)%state.foodCards.length;
    if(key==='s'){currentPlayer().foodValue+=state.foodCards[state.selectionIndex].value;state.foodCards.splice(state.selectionIndex,1);state.selectionIndex=0;}
    if(key===' ')enterStatus();
    renderScene3();
  }
  if(state.scene===5&&key===' ')enterShopping();
});
function currentPlayer(){return state.playersData[state.currentPlayer];}
</script>
</body>
</html>
